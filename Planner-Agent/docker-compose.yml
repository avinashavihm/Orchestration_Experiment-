version: '3.8'

services:
  planner-agent-backend:
    build: ./backend
    container_name: planner-agent-backend
    ports:
      - "8002:8002"
      - "4003:4003"
    environment:
      - MCP_PORT=4003
      - RECRUITMENT_AGENT_HTTP_URL=http://patient-recruitment-backend:8000
      - SUPPLY_AGENT_HTTP_URL=http://clin-supply-backend:8000
      - RECRUITMENT_AGENT_URL=ws://patient-recruitment-backend:4001
      - SUPPLY_AGENT_URL=ws://clin-supply-backend:4002
    networks:
      - agents-network

  planner-agent-frontend:
    image: node:18-alpine
    container_name: planner-agent-frontend
    working_dir: /app
    volumes:
      - ./frontend:/app
      - /app/node_modules
    ports:
      - "3004:3004"
    command: sh -c "npm install && npm run dev -- --host"
    networks:
      - agents-network

networks:
  agents-network:
    external: true
